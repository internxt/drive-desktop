name: Build Windows

#on:
#  create:
#    tags:
#      - '*'
on:
  workflow_dispatch:

jobs:
  build-windows:
    runs-on: self-hosted
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Install yarn and requirements
        run: |
          $ErrorActionPreference = "Stop"
          SET GH_TOKEN= ${{ secrets.GITHUB_TOKEN }}
          cd C:\Users\LENOVO\Desktop\Trabajo\drive-web-sign\drive-desktop
          git stash
          git pull
          npm install --global yarn
          npm install yarn --save-dev
          yarn install --network-timeout 1000000
          yarn run build
          cd ..
          python check-sign.py -ErrorAction Stop
      - name: Check file
        run: |
          cd C:\Users\LENOVO\Desktop\Trabajo\drive-web-sign\drive-desktop
          ls release/build/
